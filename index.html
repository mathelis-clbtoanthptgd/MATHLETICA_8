<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merry-Go-Round - Mathletica</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #0C1A3E 0%, #1a2a5e 100%);
            min-height: 100vh;
            color: #FFFFF0;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            background: #FFD700;
            border-radius: 50%;
            animation: twinkle 2s infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.2); }
        }

        .vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, transparent 0%, rgba(12, 26, 62, 0.3) 70%);
            pointer-events: none;
            z-index: 2;
        }

        .container {
            position: relative;
            z-index: 3;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .landing-page {
            text-align: center;
            max-width: 500px;
            width: 100%;
        }

        .game-title {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            font-weight: 700;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(255, 215, 0, 0.3);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #FFFFF0;
            margin-bottom: 40px;
            opacity: 0.9;
        }

        .ornate-frame {
            background: linear-gradient(145deg, #F5E8C7, #e8dbb5);
            border: 3px solid #FFD700;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3), inset 0 1px 3px rgba(255,255,255,0.2);
            position: relative;
        }

        .ornate-frame::before {
            content: '✦';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: #0C1A3E;
            color: #FFD700;
            font-size: 1.5rem;
            padding: 5px 15px;
            border-radius: 50%;
        }

        .name-input {
            width: 80%;
            max-width: 300px;
            padding: 15px;
            border: 2px solid #FFD700;
            border-radius: 8px;
            font-size: 1.1rem;
            background: rgba(245, 232, 199, 0.9);
            color: #0C1A3E;
            text-align: center;
            margin: 0 auto 20px auto;
            display: block;
        }

        .name-input::placeholder {
            color: #666;
            font-style: italic;
        }

        .carnival-button {
            background: linear-gradient(145deg, #FFD700, #e6c200);
            color: #0C1A3E;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 500;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .carnival-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
            background: linear-gradient(145deg, #fff700, #FFD700);
        }

        .game-page {
            display: none;
            width: 100%;
            max-width: 800px;
        }

        .game-header {
            background: rgba(12, 26, 62, 0.8);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .player-greeting {
            font-size: 1.2rem;
            color: #FFFFF0;
        }

        .timer {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #FFD700;
            font-size: 1.2rem;
            font-weight: 500;
        }

        .puzzle-frame {
            background: linear-gradient(145deg, #F5E8C7, #e8dbb5);
            border: 4px solid #FFD700;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            color: #0C1A3E;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
        }

        .puzzle-frame::before,
        .puzzle-frame::after {
            content: '❋';
            position: absolute;
            color: #FFD700;
            font-size: 2rem;
        }

        .puzzle-frame::before {
            top: 15px;
            left: 20px;
        }

        .puzzle-frame::after {
            bottom: 15px;
            right: 20px;
        }

        .puzzle-text {
            font-size: 1.3rem;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 20px;
        }

        .answer-section {
            text-align: center;
        }

        .answer-input {
            width: 200px;
            padding: 15px;
            border: 3px solid #FFD700;
            border-radius: 10px;
            font-size: 1.3rem;
            text-align: center;
            background: rgba(245, 232, 199, 0.9);
            color: #0C1A3E;
            margin: 0 10px 20px 10px;
        }

        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .popup {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #F5E8C7, #e8dbb5);
            border: 5px solid #FFD700;
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            animation: popIn 0.5s ease;
        }

        .popup-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }

        .popup-content {
            color: #0C1A3E;
            font-size: 1.2rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .trophy {
            font-size: 4rem;
            margin: 20px 0;
            animation: bounce 1s infinite alternate;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes popIn {
            from { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        .error-shake {
            animation: shake 0.5s ease-in-out;
            border-color: #ff4444 !important;
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.3) !important;
        }

        @media (max-width: 768px) {
            .game-title {
                font-size: 2.5rem;
            }
            
            .game-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .puzzle-frame {
                padding: 25px;
            }
            
            .answer-input {
                width: 150px;
            }
        }
    </style>
</head>
<body>
    <!-- Animated stars background -->
    <div class="stars" id="stars"></div>
    <div class="vignette"></div>

    <div class="container">
        <!-- Landing Page -->
        <div class="landing-page" id="landingPage">
            <h1 class="game-title">Merry-Go-Round</h1>
            <p class="subtitle">Mathletica: Đố vui không thưởng #8</p>
            
            <div class="ornate-frame">
                <input type="text" class="name-input" id="playerName" placeholder="Hãy nhập tên của bạn..." maxlength="20">
                <button class="carnival-button" onclick="startGame()">Bắt đầu chơi</button>
            </div>
        </div>

        <!-- Game Page -->
        <div class="game-page" id="gamePage">
            <div class="game-header">
                <div class="player-greeting" id="greeting">Xin chào, Người chơi!</div>
                <div class="timer">
                    <span>⏳</span>
                    <span id="timerDisplay">00:00</span>
                </div>
            </div>

            <div class="puzzle-frame">
                <div class="puzzle-text">
                    Trong lúc đang tận hưởng một chuyến đi vui vẻ trên vòng quay ngựa gỗ, cậu bé Sammy đã đưa ra một câu đố thể hiện trí thông minh tuyệt vời của mình.
                    <br><br>
                    Cậu nói rằng: <em>"Một phần ba số bạn nhỏ đang ngồi phía trước tớ, cộng với ba phần tư số bạn nhỏ đang ngồi phía sau tớ, chính là tổng số trẻ em trên vòng quay ngựa gỗ này."</em>
                    <br><br>
                    Đó là cách cậu ấy đặt câu đố. Nhưng bạn sẽ phải vắt óc suy nghĩ một chút để tìm ra chính xác có <strong>bao nhiêu người</strong> đang ở trên vòng quay xiếc này đấy !
                </div>
            </div>

            <div class="answer-section">
                <input type="number" class="answer-input" id="answerInput" placeholder="?" min="1" max="24">
                <br>
                <button class="carnival-button" onclick="checkAnswer()">Xác nhận</button>
            </div>
        </div>
    </div>

    <!-- Success Popup -->
    <div class="popup-overlay" id="popupOverlay">
        <div class="popup">
            <h2 class="popup-title">XUẤT SẮC!</h2>
            <div class="trophy">🏆</div>
            <div class="popup-content" id="popupContent">
                Chúc mừng người chơi: <strong id="winnerName"></strong><br>
                Bạn đã giải được câu đố trong thời gian: <strong id="completionTime"></strong>
            </div>
            <button class="carnival-button" onclick="playAgain()">Chơi lại</button>
        </div>
    </div>

    <script>
        let startTime;
        let timerInterval;
        const correctAnswer = 13; // Tổng số trẻ em trên vòng quay

        // Create animated stars
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = star.style.height = (Math.random() * 3 + 1) + 'px';
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }

        function startGame() {
            const playerName = document.getElementById('playerName').value.trim();
            if (!playerName) {
                alert('Vui lòng nhập tên của bạn!');
                return;
            }

            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('gamePage').style.display = 'block';
            document.getElementById('greeting').textContent = `Xin chào, ${playerName}!`;
            
            startTime = Date.now();
            startTimer();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function checkAnswer() {
            const answerInput = document.getElementById('answerInput');
            const userAnswer = parseInt(answerInput.value);
            
            if (isNaN(userAnswer)) {
                showError(answerInput, 'Vui lòng nhập một số!');
                return;
            }

            if (userAnswer === correctAnswer) {
                clearInterval(timerInterval);
                showSuccessPopup();
            } else {
                showError(answerInput);
                // Không xóa giá trị, chỉ rung và đổi màu viền
            }
        }

        function showError(inputElement, message = null) {
            // Thêm class error để tạo hiệu ứng rung và đổi màu viền
            inputElement.classList.add('error-shake');
            
            // Hiển thị thông báo nếu có
            if (message) {
                alert(message);
            }
            
            // Xóa class error sau khi animation kết thúc
            setTimeout(() => {
                inputElement.classList.remove('error-shake');
            }, 500);
            
            // Focus vào ô input
            inputElement.focus();
        }

        function showSuccessPopup() {
            const playerName = document.getElementById('playerName').value;
            const timeDisplay = document.getElementById('timerDisplay').textContent;
            
            document.getElementById('winnerName').textContent = playerName;
            document.getElementById('completionTime').textContent = timeDisplay;
            document.getElementById('popupOverlay').style.display = 'block';
        }

        function playAgain() {
            document.getElementById('popupOverlay').style.display = 'none';
            document.getElementById('gamePage').style.display = 'none';
            document.getElementById('landingPage').style.display = 'block';
            document.getElementById('playerName').value = '';
            document.getElementById('answerInput').value = '';
            clearInterval(timerInterval);
        }

        // Handle Enter key press
        document.getElementById('playerName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                startGame();
            }
        });

        document.getElementById('answerInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Initialize stars when page loads
        createStars();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98848ed4013dcb36',t:'MTc1OTQxMTg2NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
